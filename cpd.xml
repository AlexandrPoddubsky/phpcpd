<?xml version="1.0" encoding="UTF-8"?>
<pmd-cpd version="phpcpd @package_version@">
  <duplication lines="34" tokens="136">
    <file path="/usr/local/src/phpunit/trunk/PHPUnit/Extensions/Database/DataSet/AbstractTable.php" line="156"/>
    <file path="/usr/local/src/phpunit/trunk/PHPUnit/Extensions/Database/DataSet/ReplacementTable.php" line="172"/>
    <codefragment>    public function assertEquals(PHPUnit_Extensions_Database_DataSet_ITable $other)
    {
        $thisMetaData = $this-&gt;getTableMetaData();
        $otherMetaData = $other-&gt;getTableMetaData();

        $thisMetaData-&gt;assertEquals($otherMetaData);

        if ($this-&gt;getRowCount() != $other-&gt;getRowCount()) {
            throw new Exception("Expected row count of {$this-&gt;getRowCount()}, has a row count of {$other-&gt;getRowCount()}");
        }

        $columns = $thisMetaData-&gt;getColumns();
        for ($i = 0; $i &lt; $this-&gt;getRowCount(); $i++) {
            foreach ($columns as $columnName) {
                if ($this-&gt;getValue($i, $columnName) != $other-&gt;getValue($i, $columnName)) {
                    throw new Exception("Expected value of {$this-&gt;getValue($i, $columnName)} for row {$i} column {$columnName}, has a value of {$other-&gt;getValue($i, $columnName)}");
                }
            }
        }

        return TRUE;
    }

    public function __toString()
    {
        $columns = $this-&gt;getTableMetaData()-&gt;getColumns();

        $lineSeperator = str_repeat('+----------------------', count($columns)) . "+\n";
        $lineLength = strlen($lineSeperator) - 1;

        $tableString = $lineSeperator;
        $tableString .= '| ' . str_pad($this-&gt;getTableMetaData()-&gt;getTableName(), $lineLength - 4, ' ', STR_PAD_RIGHT) . " |\n";
        $tableString .= $lineSeperator;
        $tableString .= $this-&gt;rowToString($columns);
</codefragment>
  </duplication>
  <duplication lines="44" tokens="156">
    <file path="/usr/local/src/phpunit/trunk/PHPUnit/Samples/BankAccountDB/BankAccountDBTest.php" line="84"/>
    <file path="/usr/local/src/phpunit/trunk/PHPUnit/Samples/BankAccountDB/BankAccountDBTestMySQL.php" line="84"/>
    <codefragment>    protected function getDataSet()
    {
        return $this-&gt;createFlatXMLDataSet(dirname(__FILE__).'/_files/bank-account-seed.xml');
    }

    public function testNewAccountBalanceIsInitiallyZero()
    {
        $bank_account = new BankAccount('12345678912345678', $this-&gt;pdo);
        $this-&gt;assertEquals(0, $bank_account-&gt;getBalance());
    }

    public function testOldAccountInfoInitiallySet()
    {
        $bank_account = new BankAccount('15934903649620486', $this-&gt;pdo);
        $this-&gt;assertEquals(100, $bank_account-&gt;getBalance());
        $this-&gt;assertEquals('15934903649620486', $bank_account-&gt;getAccountNumber());

        $bank_account = new BankAccount('15936487230215067', $this-&gt;pdo);
        $this-&gt;assertEquals(1216, $bank_account-&gt;getBalance());
        $this-&gt;assertEquals('15936487230215067', $bank_account-&gt;getAccountNumber());

        $bank_account = new BankAccount('12348612357236185', $this-&gt;pdo);
        $this-&gt;assertEquals(89, $bank_account-&gt;getBalance());
        $this-&gt;assertEquals('12348612357236185', $bank_account-&gt;getAccountNumber());
    }

    public function testAccountBalanceDeposits()
    {
        $bank_account = new BankAccount('15934903649620486', $this-&gt;pdo);
        $bank_account-&gt;depositMoney(100);

        $bank_account = new BankAccount('15936487230215067', $this-&gt;pdo);
        $bank_account-&gt;depositMoney(230);

        $bank_account = new BankAccount('12348612357236185', $this-&gt;pdo);
        $bank_account-&gt;depositMoney(24);

           $xml_dataset = $this-&gt;createFlatXMLDataSet(dirname(__FILE__).'/_files/bank-account-after-deposits.xml');
        $this-&gt;assertDataSetsEqual($xml_dataset, $this-&gt;getConnection()-&gt;createDataSet());
    }

    public function testAccountBalanceWithdrawals()
    {
        $bank_account = new BankAccount('15934903649620486', $this-&gt;pdo);
</codefragment>
  </duplication>
  <duplication lines="26" tokens="73">
    <file path="/usr/local/src/phpunit/trunk/PHPUnit/Tests/Extensions/Database/DataSet/XmlDataSetsTest.php" line="71"/>
    <file path="/usr/local/src/phpunit/trunk/PHPUnit/Tests/Extensions/Database/DataSet/CsvDataSetTest.php" line="70"/>
    <codefragment>        $table1MetaData = new PHPUnit_Extensions_Database_DataSet_DefaultTableMetaData(
            'table1', array('table1_id', 'column1', 'column2', 'column3', 'column4')
        );
        $table2MetaData = new PHPUnit_Extensions_Database_DataSet_DefaultTableMetaData(
            'table2', array('table2_id', 'column5', 'column6', 'column7', 'column8')
        );

        $table1 = new PHPUnit_Extensions_Database_DataSet_DefaultTable($table1MetaData);
        $table2 = new PHPUnit_Extensions_Database_DataSet_DefaultTable($table2MetaData);

        $table1-&gt;addRow(array(
            'table1_id' =&gt; 1,
            'column1' =&gt; 'tgfahgasdf',
            'column2' =&gt; 200,
            'column3' =&gt; 34.64,
            'column4' =&gt; 'yghkf;a  hahfg8ja h;'
        ));
        $table1-&gt;addRow(array(
            'table1_id' =&gt; 2,
            'column1' =&gt; 'hk;afg',
            'column2' =&gt; 654,
            'column3' =&gt; 46.54,
            'column4' =&gt; '24rwehhads'
        ));
        $table1-&gt;addRow(array(
            'table1_id' =&gt; 3,
</codefragment>
  </duplication>
</pmd-cpd>
